import ctypes, re, sys
import hashlib


pid = "3344"


maps_file = open("/proc/"+pid+"/maps", 'r')
mem_file = open("/proc/"+pid+"/mem", 'rb', 0)
output_file=open('out.txt','w')
lines=maps_file.readlines()
line=lines[1]
m = re.match(r'([0-9A-Fa-f]+)-([0-9A-Fa-f]+) ([-"r-xp"])', line)
if m.group(3) == 'r':  # if this is a readable region
    start = int(m.group(1), 16)
    end = int(m.group(2), 16)
    mem_file.seek(start)  # seek to region start
    chunk = mem_file.read(end - start)  # read region contents
    output_file.write(hashlib.sha256(chunk).hexdigest())


maps_file.close()
mem_file.close()
